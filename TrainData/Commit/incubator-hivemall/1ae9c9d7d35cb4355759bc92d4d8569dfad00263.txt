import org.apache.hadoop.hive.serde2.objectinspector.StructField;
    @Nullable
    public static StructField getStructFieldRef(@Nonnull String fieldName,
            @Nonnull final List<? extends StructField> fields) {
        fieldName = fieldName.toLowerCase();
        for (StructField f : fields) {
            if (f.getFieldName().equals(fieldName)) {
                return f;
            }
        }
        // For backward compatibility: fieldNames can also be integer Strings.
        try {
            final int i = Integer.parseInt(fieldName);
            if (i >= 0 && i < fields.size()) {
                return fields.get(i);
            }
        } catch (NumberFormatException e) {
            // ignore
        }
        return null;
    }
