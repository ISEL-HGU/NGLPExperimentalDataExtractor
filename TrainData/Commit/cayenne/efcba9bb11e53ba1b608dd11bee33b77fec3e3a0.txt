import java.util.Comparator;
        // sort joins in the order PK are set in target, to avoid errors on some DBs
        List<DbJoin> joins = rel.getJoins();
        if(rel.isToPK()) {
            List<DbAttribute> pks = rel.getTargetEntity().getPrimaryKeys();
            joins.sort(Comparator.comparingInt(join -> pks.indexOf(join.getTarget())));
        }

        for (DbJoin join : joins) {
