import javax.swing.undo.UndoableEdit;
import java.util.HashMap;
import java.util.Map;

        loaderContext.addDataChannelListener(dataChannelDescriptor -> {
            GraphRegistry registry = application.getMetaData().get(dataChannelDescriptor, GraphRegistry.class);
            if(registry == null) {
                registry = new GraphRegistry();
                application.getMetaData().add(dataChannelDescriptor, registry);

            GraphMap map = registry.getGraphMap(dataChannelDescriptor);
            //apply changes
            GraphBuilder builder = map.createGraphBuilder(graphType, false);
            builder.getGraph().setScale(scale);

            // lookup
            Map<DefaultGraphCell, Map<String, ?>> propertiesMap = new HashMap<>();
            for(Map.Entry<String, Map<String, ?>> entry : GraphHandler.this.propertiesMap.entrySet()) {
                DefaultGraphCell cell = builder.getEntityCell(entry.getKey());
                propertiesMap.put(cell, entry.getValue());
            }

            builder.getGraph().getGraphLayoutCache().getModel().removeUndoableEditListener(builder);
            builder.getGraph().getGraphLayoutCache().edit(propertiesMap, null, null, new UndoableEdit[0]);
            builder.getGraph().getGraphLayoutCache().getModel().addUndoableEditListener(builder);
