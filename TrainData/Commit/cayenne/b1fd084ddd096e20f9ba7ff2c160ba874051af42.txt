import java.util.Map;
import java.util.TreeMap;

import org.apache.cayenne.map.ObjAttribute;
import org.apache.cayenne.map.ObjRelationship;
        // make sure we have attributes and relationships in order
        sortAttributes();
        sortRelationships();

    private void sortAttributes() {
        Map<String, ObjAttribute> attributeMap = new TreeMap<>(entity.getAttributeMap());
        for(Map.Entry<String, ObjAttribute> entry : attributeMap.entrySet()) {
            entity.removeAttribute(entry.getKey());
            entity.addAttribute(entry.getValue());
        }
    }

    private void sortRelationships() {
        Map<String, ObjRelationship> relationshipMap = new TreeMap<>(entity.getRelationshipMap());
        for(Map.Entry<String, ObjRelationship> entry : relationshipMap.entrySet()) {
            entity.removeRelationship(entry.getKey());
            entity.addRelationship(entry.getValue());
        }
    }
