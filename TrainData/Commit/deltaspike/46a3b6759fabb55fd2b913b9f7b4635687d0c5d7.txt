import javax.persistence.LockModeType;
import org.apache.deltaspike.data.api.Modifying;
import org.apache.deltaspike.data.api.Query;
        if (ClassUtils.containsMethod(EntityRepositoryHandler.class, context.getMethod()))
            Method executed = ClassUtils.extractMethod(EntityRepositoryHandler.class, context.getMethod());
            if (executed.isAnnotationPresent(RequiresTransaction.class))
            {
                return true;
            }

        Query query = context.getRepositoryMethodMetadata().getQuery();
        Modifying modifying = context.getRepositoryMethodMetadata().getModifying();
        
        if ((query != null && !query.lock().equals(LockModeType.NONE)) || modifying != null)
        {
            return true;
        }
        
        return false;
