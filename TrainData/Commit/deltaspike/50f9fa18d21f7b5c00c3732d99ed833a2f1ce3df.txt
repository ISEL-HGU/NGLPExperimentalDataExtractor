import org.apache.deltaspike.data.api.audit.CreatedBy;
        updatePrincipal(entity, true);
        updatePrincipal(entity, false);
    private void updatePrincipal(Object entity, boolean create)
        for (Property<Object> property : getProperties(entity, CreatedBy.class, ModifiedBy.class, create))
            setProperty(entity, property, create);
    private void setProperty(Object entity, Property<Object> property, boolean create)
            if (!isCorrectContext(property, create))
            {
                return;
            }
    private boolean isCorrectContext(Property<Object> property, boolean create)
    {
        if (create && property.getAnnotatedElement().isAnnotationPresent(ModifiedBy.class))
        {
            ModifiedBy annotation = property.getAnnotatedElement().getAnnotation(ModifiedBy.class);
            if (!annotation.onCreate())
            {
                return false;
            }
        }
        return true;
    }

