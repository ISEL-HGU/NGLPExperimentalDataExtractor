import org.apache.ivy.core.module.descriptor.ModuleDescriptor;
import org.apache.ivy.plugins.parser.ParserSettings;
import org.apache.ivy.util.Message;

        synchronized (valueMap) {
            CacheEntry entry = valueMap.get(ivyFile);
            if (entry != null) {
                if (entry.isStale(validated, ivySettings)) {
                    Message.debug("Entry is found in the ModuleDescriptorCache but entry should be "
                             "reevaluated : "  ivyFile);
                    valueMap.remove(ivyFile);
                    return null;
                } else {
                    // Move the entry at the end of the list
                    valueMap.remove(ivyFile);
                    valueMap.put(ivyFile, entry);
                    Message.debug("Entry is found in the ModuleDescriptorCache : "  ivyFile);
                    return entry.md;
                }
                Message.debug("No entry is found in the ModuleDescriptorCache : "  ivyFile);
                return null;
        synchronized (valueMap) {
            if (valueMap.size() >= maxSize) {
                Message.debug("ModuleDescriptorCache is full, remove one entry");
                Iterator<CacheEntry> it = valueMap.values().iterator();
                it.next();
                it.remove();
            }
            valueMap.put(url, new CacheEntry(descriptor, validated, ivySettingsMonitor));
