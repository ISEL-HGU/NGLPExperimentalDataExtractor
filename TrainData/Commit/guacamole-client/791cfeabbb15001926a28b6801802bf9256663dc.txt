        if (authenticatedUser instanceof LDAPAuthenticatedUser) {
            Dn bindDn = ((LDAPAuthenticatedUser) authenticatedUser).getBindDn();
            LdapNetworkConnection ldapConnection = ldapService.bindAs(bindDn, credentials.getPassword());
            try {
                // Build user context by querying LDAP
                LDAPUserContext userContext = userContextProvider.get();
                userContext.init(authenticatedUser, ldapConnection);
                return userContext;
            }

            // Always disconnect
            finally {
                ldapService.disconnect(ldapConnection);
            }
        return null;
