import java.security.Provider;
import java.security.Security;
import net.jradius.client.auth.MSCHAPv1Authenticator;
import net.jradius.client.auth.MSCHAPv2Authenticator;
        // For MSCHAPv1/2, we need MD4 support
        if (radAuth instanceof MSCHAPv1Authenticator
                || radAuth instanceof MSCHAPv2Authenticator) {
            
            Security.addProvider(new Provider("MD4", 0.00, "MD4 for MSCHAPv1/2 RADIUS") {
                {
                    this.put("MessageDigest.MD4", org.bouncycastle.jce.provider.JDKMessageDigest.MD4.class.getName());
                }
            });
    
        }

