        // Veto authentication result if account is required but unavailable
        // due to account restrictions
        if (environment.isUserRequired()
                && (userModel.isDisabled() || !user.isAccountValid() || !user.isAccountAccessible())) {
                throw new GuacamoleInvalidCredentialsException("Invalid login",
                        CredentialsInfo.USERNAME_PASSWORD);
        }

        // Update password if password is expired
