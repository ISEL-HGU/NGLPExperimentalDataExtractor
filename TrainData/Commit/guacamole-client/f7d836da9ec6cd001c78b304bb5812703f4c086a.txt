import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import org.apache.guacamole.GuacamoleServerException;
            try {
                Provider md4Provider;
                Constructor providerConstructor = Provider.class
                        .getConstructor(String.class, String.class, String.class);
                if (providerConstructor != null)
                    md4Provider = (Provider) providerConstructor
                            .newInstance("MD4", "0.00", "MD4 for MSCHAPv1/2 Support");
                else
                    md4Provider = (Provider) Provider.class
                            .getConstructor(String.class, Double.class, String.class)
                            .newInstance("MD4", 0.00, "MD4 for MSCHAPv1/2 Support");

                assert(md4Provider != null);
                md4Provider.put("MessageDigest.MD4", org.bouncycastle.jce.provider.JDKMessageDigest.MD4.class.getName());
                Security.addProvider(md4Provider);
            }
            catch (IllegalAccessException
                    | InstantiationException
                    | InvocationTargetException
                    | NoSuchMethodException e) {
                throw new GuacamoleServerException("Unable to load MD4 support.", e);
            }
