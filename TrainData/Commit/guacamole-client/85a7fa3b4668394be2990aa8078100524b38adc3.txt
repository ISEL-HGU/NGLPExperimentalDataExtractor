import org.apache.guacamole.auth.radius.form.GuacamoleRadiusChallenge;
     * Returns an object containing the challenge message and the expected
     * credentials from a RADIUS challenge.
     *     A GuacamoleRadiusChallenge object that contains the challenge message
     *     sent by the RADIUS server and the expected credentials that should
     *     be requested of the user in order to continue authentication.  One
     *     of the expected credentials *must* be the RADIUS state.
    private GuacamoleRadiusChallenge getRadiusChallenge(RadiusPacket challengePacket) {
        logger.debug("Received challenge: {}", replyAttr.toString());
        String replyMsg = replyAttr.toString().split(" = ", 2)[1];
        // Return the GuacamoleRadiusChallenge object that has the state
        // and the expected response.
        return new GuacamoleRadiusChallenge(replyMsg,
                new CredentialsInfo(Arrays.asList(radiusResponseField,
                        radiusStateField)));
            GuacamoleRadiusChallenge challenge = getRadiusChallenge(radPack);
            if (challenge == null)
            throw new GuacamoleInsufficientCredentialsException(
                    challenge.getChallengeText(),
                    challenge.getExpectedCredentials());
