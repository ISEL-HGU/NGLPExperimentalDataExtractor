     * @param guacamoleStatusCode
     *     The GuacamoleStatus code to send.
     *
     * @param guacamoleHttpCode
     *     The numeric HTTP code to send.
     *
     * @param message
     *     The human-readable error message to send.
    protected void sendError(HttpServletResponse response, int guacamoleStatusCode,
            int guacamoleHttpCode, String message)

                response.addHeader("Guacamole-Status-Code", Integer.toString(guacamoleStatusCode));
                response.addHeader("Guacamole-Error-Message", message);
                response.sendError(guacamoleHttpCode);
            if (e instanceof GuacamoleClientException) {
                logger.warn("HTTP tunnel request rejected: {}", e.getMessage());
                sendError(response, e.getStatus().getGuacamoleStatusCode(),
                        e.getStatus().getHttpStatusCode(), e.getMessage());
            }
            else {
                logger.error("HTTP tunnel request failed: {}", e.getMessage());
                logger.debug("Internal error in HTTP tunnel.", e);
                sendError(response, e.getStatus().getGuacamoleStatusCode(),
                        e.getStatus().getHttpStatusCode(), "Internal server error.");
            }
