import java.nio.charset.StandardCharsets;
import java.util.Base64;
public final class AuthenticationRequestFilter implements ClientRequestFilter {
    private final OAuthToken authToken;
    public AuthenticationRequestFilter(ServiceNowConfiguration conf) throws IOException {
        this.authToken = conf.hasOAuthAuthentication() ? new OAuthToken(conf) : null;
        this.authString = conf.hasBasicAuthentication() ? getBasicAuthenticationString(conf) : null;
        if (authToken != null) {
            requestContext.getHeaders().add(HttpHeaders.AUTHORIZATION, authToken.getAuthString());
    private static String getBasicAuthenticationString(ServiceNowConfiguration conf) {
        String userAndPassword = conf.getUserName()  ":"  conf.getPassword();
        return "Basic "  Base64.getEncoder().encodeToString(userAndPassword.getBytes(StandardCharsets.UTF_8));
