import java.util.HashSet;
import org.apache.camel.util.ObjectHelper;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
            // okay no application context specified so lets look for either
            // classpath xml or annotation based
            if (routeBuilderClasses != null) {
                AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext();
                ac.register(SpringCamelContext.class);
                Set<String> packages = new LinkedHashSet<>();
                String[] classes = routeBuilderClasses.split(",");
                for (String clazz : classes) {
                    if (clazz.contains(".")) {
                        String packageName = clazz.substring(0, clazz.lastIndexOf("."));
                        packages.add(packageName);
                    }
                }
                LOG.info("Using Spring annotation scanning in packages: {}", packages);
                ac.scan(packages.toArray(new String[packages.size()]));
                ac.refresh();
                return ac;
            } else {
                return new ClassPathXmlApplicationContext();
            }
