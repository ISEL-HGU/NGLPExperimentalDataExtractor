import java.util.Arrays;
                
                List<Bson> queryList;
                    queryList = query.stream().map(o -> (Bson)o).collect(Collectors.toList());
                    queryList = Arrays.asList(Bson.class.cast(exchange.getIn().getMandatoryBody(Bson.class)));
                
                // The number to skip must be in body query
                AggregateIterable<Document> aggregationResult = dbCol.aggregate(queryList);
                
                // get the batch size
                Integer batchSize = exchange.getIn().getHeader(MongoDbConstants.BATCH_SIZE, Integer.class);
                
                if (batchSize != null) {
                    aggregationResult.batchSize(batchSize);
                }
                
                Iterable<Document> result;                
                if (!MongoDbOutputType.MongoIterable.equals(endpoint.getOutputType())) {
                    try {
                        result = new ArrayList<>();
                        aggregationResult.iterator().forEachRemaining(((List<Document>) result)::add);
                        exchange.getOut().setHeader(MongoDbConstants.RESULT_PAGE_SIZE, ((List<Document>) result).size());
                    } finally {
                        aggregationResult.iterator().close();
                    }
                } else {
                    result = aggregationResult;
                }
                
                return result;
