        try {
            return doConnect(configuration);
        } catch (GenericFileOperationFailedException e) {
            listener.onGeneralError(endpoint.getConfiguration().remoteServerInformation(), e.getMessage());
            throw e;
        }
    }

    protected boolean doConnect(RemoteFileConfiguration configuration) throws GenericFileOperationFailedException {
                listener.onLoginFailed(replyCode, replyString);
        try {
            doDisconnect();
        } catch (GenericFileOperationFailedException e) {
            listener.onGeneralError(endpoint.getConfiguration().remoteServerInformation(), e.getMessage());
            throw e;
        }
    }

    protected void doDisconnect() throws GenericFileOperationFailedException {
        try {
            log.trace("retrieveFile({})", name);
            if (ObjectHelper.isNotEmpty(endpoint.getLocalWorkDirectory())) {
                // local work directory is configured so we should store file content as files in this local directory
                answer = retrieveFileToFileInLocalWorkDirectory(name, exchange);
            } else {
                // store file content directory as stream on the body
                answer = retrieveFileToStreamInBody(name, exchange);
            }
        } catch (GenericFileOperationFailedException e) {
            listener.onGeneralError(endpoint.getConfiguration().remoteServerInformation(), e.getMessage());
            throw e;
        } catch (GenericFileOperationFailedException e) {
            listener.onGeneralError(endpoint.getConfiguration().remoteServerInformation(), e.getMessage());
            throw e;
            listener.onGeneralError(endpoint.getConfiguration().remoteServerInformation(), e.getMessage());
            listener.onGeneralError(endpoint.getConfiguration().remoteServerInformation(), e.getMessage());
