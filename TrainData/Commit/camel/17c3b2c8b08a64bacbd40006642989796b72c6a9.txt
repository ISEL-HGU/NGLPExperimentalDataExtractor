import org.apache.camel.AsyncProducer;
import org.apache.camel.support.service.ServiceHelper;
import org.apache.camel.support.service.ServiceSupport;
public class GrpcResponseRouterStreamObserver extends ServiceSupport implements StreamObserver<Object> {
    private Endpoint endpoint;
    private AsyncProducer producer;
    public GrpcResponseRouterStreamObserver(GrpcConfiguration configuration, Endpoint sourceEndpoint) throws Exception {
        producer.processAsync(exchange);
    @Override
    protected void doStart() throws Exception {
        this.endpoint = CamelContextHelper.getMandatoryEndpoint(sourceEndpoint.getCamelContext(), configuration.getStreamRepliesTo());
        this.producer = endpoint.createAsyncProducer();
        ServiceHelper.startService(producer);
    }

    @Override
    protected void doStop() throws Exception {
        ServiceHelper.stopService(producer);
    }
