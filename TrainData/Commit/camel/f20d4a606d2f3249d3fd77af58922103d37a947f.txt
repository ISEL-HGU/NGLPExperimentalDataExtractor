import org.springframework.ws.mime.Attachment;
                    exchange.getOut().copyFromWithNewBody(exchange.getIn(), soapMessage.getPayloadSource());
                    populateHeaderAndAttachmentsFromResponse(exchange.getOut(), soapMessage);
                    exchange.getIn().setBody(soapMessage.getPayloadSource());
                    populateHeaderAndAttachmentsFromResponse(exchange.getIn(), soapMessage);
    /**
     * Populates soap message headers and attachments from soap response
     * @param inOrOut {@link Message}
     * @param soapMessage {@link SoapMessage}
     */
    private void populateHeaderAndAttachmentsFromResponse(Message inOrOut, SoapMessage soapMessage) {
    	 if (soapMessage.getSoapHeader() != null && getEndpoint().getConfiguration().isAllowResponseHeaderOverride()) { 
    		 populateMessageHeaderFromResponse(inOrOut, soapMessage.getSoapHeader());
    	 }
    	 if (soapMessage.getAttachments() != null && getEndpoint().getConfiguration().isAllowResponseAttachmentOverride()) {
    		 populateMessageAttachmentsFromResponse(inOrOut, soapMessage.getAttachments());
    	 }
    }
    /**
     * Populates message attachments from soap response attachments 
     * @param inOrOut {@link Message}
     * @param soapMessage {@link SoapMessage}
     */
    private void populateMessageAttachmentsFromResponse(Message inOrOut, Iterator<Attachment> attachments) {
    	while (attachments.hasNext()) {
    		Attachment attachment = attachments.next();
    		inOrOut.getAttachments().put(attachment.getContentId(), attachment.getDataHandler());
    	}
    }    
    
