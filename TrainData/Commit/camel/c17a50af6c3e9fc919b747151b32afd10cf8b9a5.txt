import java.nio.charset.Charset;
import java.util.Base64;
import org.apache.http.Header;
    
    public static final String USERNAME = "ben";
    public static final String PASSWORD = "password123";
        // make sure that our writing operations have authentication header
        if (!authenticate(requestWrapper)) {
            response.setStatusCode(HttpStatus.SC_FORBIDDEN);
            response.setEntity(new StringEntity("Forbidden", ContentType.TEXT_PLAIN));
            return;
        }
    private boolean authenticate(HttpRequestWrapper request) {
        // read operations don't need to authenticate
        if (request.getMethod().contentEquals("GET")) {
            return true;
        }
        for (Header authorizationHeader : request.getHeaders("Authorization")) {
            // Authorization: Basic base64credentials
            String base64Credentials = authorizationHeader.getValue().substring("Basic".length()).trim();
            String credentials = new String(Base64.getDecoder().decode(base64Credentials), Charset.forName("UTF-8"));
            // credentials = username:password
            final String[] values = credentials.split(":", 2);
            return USERNAME.equals(values[0]) && PASSWORD.equals(values[1]);
        }
        return false;
    }
