import java.util.HashSet;
import java.util.Set;
        // store keys to be removed as we cannot loop and remove at the same time in implementations such as HashMap
        Set<String> toBeRemoved = new HashSet<>();
        for (String key : properties.keySet()) {
                toBeRemoved.add(key);

        if (!toBeRemoved.isEmpty()) {
            if (toBeRemoved.size() == properties.size()) {
                // special optimization when all should be removed
                properties.clear();
            } else {
                toBeRemoved.forEach(k -> properties.remove(k));
            }
        }

        return new HashMap<>();
        return new HashMap<>(properties);
