
import org.apache.camel.http.common.CamelServlet;
import org.apache.camel.http.common.HttpConsumer;
import static io.netty.handler.codec.http.HttpResponseStatus.METHOD_NOT_ALLOWED;
        HttpServerChannelHandler handler = getHandler(request, request.method().name());
            // okay we cannot process this requires so return either 404 or 405.
            // to know if its 405 then we need to check if any other HTTP method would have a consumer for the "same" request
            boolean hasAnyMethod = CamelServlet.METHODS.stream().anyMatch(m -> isHttpMethodAllowed(request, m));
            HttpResponse response = null;
            if (hasAnyMethod) {
                //method match error, return 405
                response = new DefaultHttpResponse(HTTP_1_1, METHOD_NOT_ALLOWED);
            } else {
                // this resource is not found, return 404
                response = new DefaultHttpResponse(HTTP_1_1, NOT_FOUND);
            }
    private boolean isHttpMethodAllowed(HttpRequest request, String method) {
        return getHandler(request, method) != null;
    }
    
    private HttpServerChannelHandler getHandler(HttpRequest request, String method) {
