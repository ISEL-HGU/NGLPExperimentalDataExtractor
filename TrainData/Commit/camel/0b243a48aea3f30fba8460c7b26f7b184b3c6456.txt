import com.univocity.parsers.common.AbstractWriter;

import static org.apache.camel.util.ExchangeHelper.convertToMandatoryType;
import static org.apache.camel.util.ExchangeHelper.convertToType;
 * This class marshalls the exchange body using an uniVocity writer. It can
 * automatically generates headers and keep their order in memory.
     * @param headers the base headers to use
     * @param adaptHeaders whether or not we can add headers on the fly
     *            depending on the data
     * @param body body to marshal
     * @param writer uniVocity writer to use
     * @throws NoTypeConversionAvailableException when it's not possible to
     *             convert the body as list and maps.
     * @param row row to write
     * @param writer uniVocity writer to use
     * @throws NoTypeConversionAvailableException when it's not possible to
     *             convert the row as map.
        Object[] values = new Object[headers.size()];
        int index = 0;
        for (String header : headers) {
            values[index] = map.get(header);
        }
        writer.writeRow(values);
