import org.elasticsearch.xpack.client.PreBuiltXPackTransportClient;
        this.client = endpoint.getClient();
                client = new PreBuiltXPackTransportClient(getSettings())
        final Settings.Builder settings = Settings.builder()
            .put("cluster.name", configuration.getClusterName())
            .put("client.transport.ignore_cluster_name", false)
            .put("client.transport.sniff", configuration.getClientTransportSniff())
            .put("transport.ping_schedule", configuration.getPingSchedule())
            .put("client.transport.ping_timeout", configuration.getPingTimeout())
            .put("client.transport.sniff", configuration.getClientTransportSniff())
            .put("request.headers.X-Found-Cluster", configuration.getClusterName());//according to the documentation this should be the same as cluster name

        if (configuration.getUser() != null && configuration.getPassword() != null) {
            settings.put("xpack.security.user", configuration.getUser() ":" configuration.getPassword())
            .put("xpack.security.transport.ssl.enabled", configuration.getEnabledSSL());
        }
        return settings.build();
