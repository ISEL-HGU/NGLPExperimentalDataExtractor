        String partition = getValue(exchange, PARTITION, Integer.class);
        String offset = getValue(exchange, OFFSET, Long.class);
    /**
     * Extracts header value from the exchange for given header
     * @param exchange the {@link Exchange}
     * @param header the header name
     * @param type the class type of the exchange header
     * @return
     */
    private <T> String getValue(final Exchange exchange, final String header, Class<T> type) {
         T partition = exchange.getIn().getHeader(header, type);
         return partition != null ? String.valueOf(partition) : exchange.getIn().getHeader(header, String.class);
    }

