import org.springframework.ldap.core.ContextSource;
import org.springframework.ldap.core.support.BaseLdapPathContextSource;
        LdapTemplate ldapTemplate = endpoint.getLdapTemplate();

        if (StringUtils.isBlank(dn)) {
            ContextSource contextSource = ldapTemplate.getContextSource();
            if (contextSource instanceof BaseLdapPathContextSource) {
		dn = ((BaseLdapPathContextSource) contextSource).getBaseLdapPathAsString();
	    }
        }
