        if (truststore != null) {
            Enumeration<String> aliases = truststore.aliases();
            List<Certificate> trustCerts = new ArrayList<>();
            while (aliases.hasMoreElements()) {
                String alias = aliases.nextElement();
                X509Certificate cert = (X509Certificate) truststore.getCertificate(alias);
                if (cert != null) {
                    trustCerts.add(cert);
                }
            
            return trustCerts.toArray(new Certificate[0]);
        return new Certificate[0];

        DtlsConnectorConfig.Builder builder = new DtlsConnectorConfig.Builder();
        if (client) {
            if (getTruststore() == null) {
                throw new IllegalStateException("A truststore must be configured to use TLS");
            }
            
            builder.setClientOnly();
        } else {
            if ((isClientAuthenticationRequired() || isClientAuthenticationWanted())
                && getTruststore() == null) {
                throw new IllegalStateException("A truststore must be configured to support TLS client authentication");
            }
            
