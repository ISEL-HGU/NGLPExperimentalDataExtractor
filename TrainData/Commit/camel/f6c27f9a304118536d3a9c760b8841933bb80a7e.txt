import org.apache.camel.support.SynchronizationAdapter;
 * SessionTransactionSynchronization is called at the completion of each {@link org.apache.camel.Exchange}.
 * <p/>
 * The commit or rollback on the {@link Session} must be performed from the same thread that consumed the message.
public class SessionTransactionSynchronization extends SynchronizationAdapter {
    private static final Logger LOG = LoggerFactory.getLogger(SessionTransactionSynchronization.class);

    private final Session session;

                LOG.debug("Processing failure of Exchange id: {}", exchange.getExchangeId());
            LOG.warn("Failed to rollback the session: {}", e.getMessage());
                LOG.debug("Processing completion of Exchange id: {}", exchange.getExchangeId());
            LOG.warn("Failed to commit the session: {}", e.getMessage());
    @Override
    public boolean allowHandover() {
        // must not handover as we should be synchronous
        return false;
    }
