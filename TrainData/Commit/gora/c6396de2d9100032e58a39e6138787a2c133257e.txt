
import java.util.Arrays;
import java.util.HashSet;
import java.util.List;
import java.util.Locale;
import java.util.Properties;
import java.util.Set;
  private boolean isPrimaryKeyIncluded(String[] fields) {
    HashSet<String> luceneFields = new HashSet<>();
    if (fields.length > 0) {
      for (String field : fields) {
        luceneFields.add(getMapping().getLuceneField(field));
      }
    }
    return luceneFields.contains(getMapping().getPrimaryKey());
  }
      if (query.getFields() == null || (query.getFields().length == getFields().length)
              || isPrimaryKeyIncluded(query.getFields())) {
        Query<K, T> selectQuery = this.newQuery();
        ScoreDoc[] scoreDocs = selectResult.getScoreDocs();
            doc.add(new StringField(mapping.getPrimaryKey(), key, Store.YES));
        selectResult.close();
