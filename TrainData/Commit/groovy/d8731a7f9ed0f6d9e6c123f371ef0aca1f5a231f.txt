    private static boolean isDirectAccessAllowed(FieldNode field, ClassNode receiver, boolean isSamePackage) {
        ClassNode declaringClass = field.getDeclaringClass().redirect();
        // first, direct access from within the class
        if (field.isPrivate()) return false;

        // now, inner class node access to outer class fields
        receiverType = receiverType.getOuterClass();
        while (receiverType != null) {
            if (declaringClass.equals(receiverType)) {
                return true;
            receiverType = receiverType.getOuterClass();
        // finally public and inherited
        return field.isPublic() || isSamePackage;
