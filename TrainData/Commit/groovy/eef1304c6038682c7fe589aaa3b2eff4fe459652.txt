
        private static final Object LOCK = new Object();

            synchronized (LOCK) {
                categoriesInUse;
                DefaultMetaClassInfo.setCategoryUsed(true);
            }
            synchronized (LOCK) {
                if (--categoriesInUse == 0) {
                    DefaultMetaClassInfo.setCategoryUsed(false);
                }
            }
        /*
         * Synchronization is avoided here for performance reasons since
         * this method is called frequently from callsite locations. For
         * a typical case when no Categories are in use the initialized
         * value of 0 will be correctly read. For cases where multiple
         * Threads are using Categories it is possible that a stale
         * non-zero value may be read but in that case the ThreadLocal
         * check will produce the correct result. When the current Thread
         * is using Categories, it would have incremented the counter
         * so whatever version of the value it observes here should be
         * non-zero and good enough for the purposes of this quick exit
         * check.
         */
        if (categoriesInUse == 0) {
            return false;
        }
    /**
     * @deprecated use {@link #hasCategoryInCurrentThread()}
     */
    @Deprecated
        synchronized (ThreadCategoryInfo.LOCK) {
            return categoriesInUse != 0;
        }
